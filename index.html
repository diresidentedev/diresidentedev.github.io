<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>F√≠sica M√©dica - Biblioteca de Aulas</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #3b82f6;
  --primary-dark: #2563eb;
  --primary-light: #60a5fa;
  --secondary: #10b981;
  --accent: #f59e0b;
  --danger: #ef4444;
  --purple: #8b5cf6;
  --dark: #0f172a;
  --dark-card: #1e293b;
  --dark-hover: #334155;
  --gray-100: #f1f5f9;
  --gray-300: #cbd5e1;
  --gray-400: #94a3b8;
  --gray-500: #64748b;
  --gray-600: #475569;
  --white: #ffffff;
  --glass: rgba(255, 255, 255, 0.05);
  --glass-border: rgba(255, 255, 255, 0.1);
  --radius: 12px;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
  --transition: all 0.3s ease;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(135deg, var(--dark) 0%, #1a1a2e 100%);
  color: var(--gray-300);
  min-height: 100vh;
  line-height: 1.6;
}

/* Toast */
.toast-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.toast {
  padding: 1rem 1.5rem;
  border-radius: var(--radius);
  background: var(--dark-card);
  border: 1px solid var(--glass-border);
  color: var(--white);
  animation: slideIn 0.3s ease;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  box-shadow: var(--shadow);
}

.toast.success { border-left: 4px solid var(--secondary); }
.toast.error { border-left: 4px solid var(--danger); }
.toast.info { border-left: 4px solid var(--primary); }

@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

/* Header */
header {
  background: var(--dark-card);
  border-bottom: 1px solid var(--glass-border);
  padding: 1rem 2rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 100;
  backdrop-filter: blur(10px);
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.logo {
  font-size: 2rem;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.brand-text {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--white);
}

nav {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

nav a {
  padding: 0.5rem 1rem;
  color: var(--gray-400);
  text-decoration: none;
  border-radius: 8px;
  transition: var(--transition);
  font-size: 0.9rem;
}

nav a:hover, nav a.active {
  background: var(--glass);
  color: var(--white);
}

/* Main */
main {
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.header-content h1 {
  font-size: 2rem;
  color: var(--white);
  margin-bottom: 0.5rem;
}

.header-content p {
  color: var(--gray-400);
}

/* Buttons */
.btn {
  padding: 0.75rem 1.5rem;
  border-radius: var(--radius);
  border: none;
  cursor: pointer;
  font-weight: 600;
  font-size: 0.9rem;
  transition: var(--transition);
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: var(--white);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
}

.btn-secondary {
  background: var(--dark-hover);
  color: var(--gray-300);
  border: 1px solid var(--glass-border);
}

.btn-success {
  background: linear-gradient(135deg, var(--secondary), #059669);
  color: var(--white);
}

.btn-danger {
  background: var(--danger);
  color: var(--white);
}

.btn-icon {
  width: 40px;
  height: 40px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: 8px;
  color: var(--gray-300);
}

/* Stats Grid */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.stat-card {
  background: var(--dark-card);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 1.5rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  transition: var(--transition);
}

.stat-card:hover {
  transform: translateY(-3px);
  border-color: var(--primary);
}

.stat-icon {
  font-size: 2rem;
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--glass);
  border-radius: var(--radius);
}

.stat-info h3 {
  font-size: 1.75rem;
  color: var(--white);
  font-weight: 700;
}

.stat-info p {
  color: var(--gray-400);
  font-size: 0.9rem;
}

/* Toolbar */
.toolbar {
  display: flex;
  gap: 1rem;
  margin-bottom: 2rem;
  flex-wrap: wrap;
  align-items: center;
}

.search-box {
  flex: 1;
  min-width: 250px;
}

.search-box input {
  width: 100%;
  padding: 0.75rem 1rem;
  background: var(--dark-card);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  color: var(--white);
  font-size: 0.95rem;
}

.search-box input:focus {
  outline: none;
  border-color: var(--primary);
}

.filter-group {
  display: flex;
  gap: 0.75rem;
  align-items: center;
}

.filter-group select {
  padding: 0.75rem 1rem;
  background: var(--dark-card);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  color: var(--white);
  font-size: 0.9rem;
  cursor: pointer;
}

/* Aulas Container */
.aulas-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 1.5rem;
}

.aulas-container.list-view {
  grid-template-columns: 1fr;
}

/* Aula Card */
.aula-card {
  background: var(--dark-card);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  overflow: hidden;
  transition: var(--transition);
  cursor: pointer;
}

.aula-card:hover {
  transform: translateY(-5px);
  border-color: var(--primary);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

.aula-card-header {
  padding: 1.25rem;
  border-bottom: 1px solid var(--glass-border);
  display: flex;
  align-items: flex-start;
  gap: 1rem;
}

.aula-icon {
  width: 50px;
  height: 50px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  flex-shrink: 0;
}

.aula-icon.html { background: linear-gradient(135deg, #f97316, #ea580c); }
.aula-icon.pdf { background: linear-gradient(135deg, #ef4444, #dc2626); }
.aula-icon.pptx { background: linear-gradient(135deg, #f59e0b, #d97706); }
.aula-icon.video { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }

.aula-title {
  flex: 1;
}

.aula-title h3 {
  color: var(--white);
  font-size: 1.1rem;
  margin-bottom: 0.25rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.aula-title h3 .favorite-star {
  color: var(--accent);
}

.aula-title .category-badge {
  display: inline-block;
  padding: 0.2rem 0.6rem;
  background: var(--glass);
  border-radius: 20px;
  font-size: 0.75rem;
  color: var(--gray-400);
}

.aula-card-body {
  padding: 1.25rem;
}

.aula-description {
  color: var(--gray-400);
  font-size: 0.9rem;
  margin-bottom: 1rem;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.aula-meta {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  font-size: 0.85rem;
  color: var(--gray-500);
}

.aula-meta span {
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.aula-card-footer {
  padding: 1rem 1.25rem;
  border-top: 1px solid var(--glass-border);
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
}

.aula-card-footer .btn {
  padding: 0.5rem 1rem;
  font-size: 0.85rem;
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 4rem 2rem;
  grid-column: 1 / -1;
}

.empty-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
  opacity: 0.5;
}

.empty-state h3 {
  color: var(--white);
  margin-bottom: 0.5rem;
}

.empty-state p {
  color: var(--gray-400);
  margin-bottom: 1.5rem;
}

/* Modal */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 2rem;
  overflow-y: auto;
}

.modal-overlay.active {
  display: flex;
}

.modal {
  background: var(--dark-card);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  width: 100%;
  max-width: 600px;
  max-height: 90vh;
  overflow-y: auto;
}

.modal-large {
  max-width: 95vw;
  max-height: 95vh;
}

.modal-header {
  padding: 1.5rem;
  border-bottom: 1px solid var(--glass-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  background: var(--dark-card);
  z-index: 10;
}

.modal-header h3 {
  color: var(--white);
  font-size: 1.25rem;
}

.close-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: none;
  background: var(--glass);
  color: var(--gray-400);
  font-size: 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
}

.close-btn:hover {
  background: var(--danger);
  color: var(--white);
}

/* Form */
form {
  padding: 1.5rem;
}

.form-group {
  margin-bottom: 1.25rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  color: var(--gray-300);
  font-weight: 500;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 0.75rem 1rem;
  background: var(--dark);
  border: 1px solid var(--glass-border);
  border-radius: 8px;
  color: var(--white);
  font-size: 0.95rem;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary);
}

.form-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
}

.checkbox-label input {
  width: auto;
}

.form-actions {
  display: flex;
  gap: 1rem;
  justify-content: flex-end;
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--glass-border);
}

/* File Upload */
.file-upload-area {
  border: 2px dashed var(--glass-border);
  border-radius: var(--radius);
  padding: 2rem;
  text-align: center;
  cursor: pointer;
  transition: var(--transition);
}

.file-upload-area:hover {
  border-color: var(--primary);
  background: var(--glass);
}

.upload-icon {
  font-size: 3rem;
  display: block;
  margin-bottom: 1rem;
}

.file-preview {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: var(--glass);
  border-radius: 8px;
}

.file-icon {
  font-size: 2rem;
}

.file-info {
  flex: 1;
  text-align: left;
}

.file-info strong {
  color: var(--white);
  display: block;
}

.file-info small {
  color: var(--gray-400);
}

.btn-remove {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  border: none;
  background: var(--danger);
  color: var(--white);
  cursor: pointer;
}

/* Viewer */
.viewer-container {
  padding: 1rem;
  min-height: 70vh;
}

.viewer-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 50vh;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 4px solid var(--glass-border);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Footer */
footer {
  padding: 2rem;
  text-align: center;
  border-top: 1px solid var(--glass-border);
  margin-top: 3rem;
}

.signature {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  color: var(--gray-500);
}

.developer-name {
  color: var(--primary);
  font-weight: 600;
}

/* Category Colors */
.category-fisica-radiacao { color: #f97316; }
.category-dosimetria { color: #3b82f6; }
.category-controle-qualidade { color: #10b981; }
.category-planejamento { color: #8b5cf6; }
.category-braquiterapia { color: #ec4899; }
.category-radiobiologia { color: #14b8a6; }
.category-protecao-radiologica { color: #f59e0b; }
.category-outros { color: #64748b; }

/* Responsive */
@media (max-width: 768px) {
  header {
    flex-direction: column;
    gap: 1rem;
  }
  
  nav {
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .page-header {
    flex-direction: column;
    text-align: center;
  }
  
  .toolbar {
    flex-direction: column;
  }
  
  .search-box {
    width: 100%;
  }
  
  .filter-group {
    width: 100%;
    flex-wrap: wrap;
  }
  
  .form-grid {
    grid-template-columns: 1fr;
  }
  
  .aulas-container {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body>

<div class="toast-container" id="toastContainer"></div>

<!-- Modal Upload -->
<div class="modal-overlay" id="uploadModal">
  <div class="modal">
    <div class="modal-header">
      <h3>üì§ Adicionar Nova Aula</h3>
      <button class="close-btn" onclick="closeUploadModal()">√ó</button>
    </div>
    <form id="uploadForm" onsubmit="saveAula(event)">
      <div class="form-group">
        <label>üìö T√≠tulo da Aula *</label>
        <input type="text" id="aulaTitle" required placeholder="Ex: Dosimetria Cl√≠nica - Parte 1">
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label>üìÇ Categoria *</label>
          <select id="aulaCategory" required>
            <option value="">Selecione...</option>
            <option value="fisica-radiacao">F√≠sica das Radia√ß√µes</option>
            <option value="dosimetria">Dosimetria</option>
            <option value="controle-qualidade">Controle de Qualidade</option>
            <option value="planejamento">Planejamento</option>
            <option value="braquiterapia">Braquiterapia</option>
            <option value="radiobiologia">Radiobiologia</option>
            <option value="protecao-radiologica">Prote√ß√£o Radiol√≥gica</option>
            <option value="outros">Outros</option>
          </select>
        </div>

        <div class="form-group">
          <label>üìÖ Data da Aula</label>
          <input type="date" id="aulaDate">
        </div>
      </div>

      <div class="form-group">
        <label>üë®‚Äçüè´ Professor/Instrutor</label>
        <input type="text" id="aulaProfessor" placeholder="Ex: Dr. Jo√£o Silva">
      </div>

      <div class="form-group">
        <label>üìù Descri√ß√£o</label>
        <textarea id="aulaDescription" rows="3" placeholder="Breve descri√ß√£o do conte√∫do da aula..."></textarea>
      </div>

      <div class="form-group">
        <label>üîó Caminho do Arquivo *</label>
        <input type="text" id="aulaFilePath" required placeholder="aulas/categoria/nome-arquivo.html">
        <small style="color: var(--gray-500); margin-top: 0.5rem; display: block;">
          Caminho relativo para o arquivo (ex: aulas/icru/icru50_62.html)
        </small>
      </div>

      <div class="form-group">
        <label>üìÑ Tipo de Arquivo *</label>
        <select id="aulaFileType" required>
          <option value="html">HTML (Apresenta√ß√£o)</option>
          <option value="pdf">PDF</option>
          <option value="pptx">PowerPoint</option>
          <option value="video">V√≠deo</option>
        </select>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input type="checkbox" id="aulaFavorite">
          <span>‚≠ê Marcar como favorita</span>
        </label>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeUploadModal()">Cancelar</button>
        <button type="submit" class="btn btn-success">üíæ Salvar Aula</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Visualiza√ß√£o -->
<div class="modal-overlay" id="viewModal">
  <div class="modal modal-large">
    <div class="modal-header">
      <h3 id="viewTitle">üìñ Visualizando Aula</h3>
      <button class="close-btn" onclick="closeViewModal()">√ó</button>
    </div>
    <div class="viewer-container" id="viewerContainer">
      <div class="viewer-loading">
        <div class="spinner"></div>
        <p>Carregando arquivo...</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal Edi√ß√£o -->
<div class="modal-overlay" id="editModal">
  <div class="modal">
    <div class="modal-header">
      <h3>‚úèÔ∏è Editar Aula</h3>
      <button class="close-btn" onclick="closeEditModal()">√ó</button>
    </div>
    <form id="editForm" onsubmit="updateAula(event)">
      <input type="hidden" id="editId">
      <div class="form-group">
        <label>üìö T√≠tulo da Aula *</label>
        <input type="text" id="editTitle" required>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label>üìÇ Categoria *</label>
          <select id="editCategory" required>
            <option value="fisica-radiacao">F√≠sica das Radia√ß√µes</option>
            <option value="dosimetria">Dosimetria</option>
            <option value="controle-qualidade">Controle de Qualidade</option>
            <option value="planejamento">Planejamento</option>
            <option value="braquiterapia">Braquiterapia</option>
            <option value="radiobiologia">Radiobiologia</option>
            <option value="protecao-radiologica">Prote√ß√£o Radiol√≥gica</option>
            <option value="outros">Outros</option>
          </select>
        </div>

        <div class="form-group">
          <label>üìÖ Data da Aula</label>
          <input type="date" id="editDate">
        </div>
      </div>

      <div class="form-group">
        <label>üë®‚Äçüè´ Professor/Instrutor</label>
        <input type="text" id="editProfessor">
      </div>

      <div class="form-group">
        <label>üìù Descri√ß√£o</label>
        <textarea id="editDescription" rows="3"></textarea>
      </div>

      <div class="form-group">
        <label>üîó Caminho do Arquivo</label>
        <input type="text" id="editFilePath">
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input type="checkbox" id="editFavorite">
          <span>‚≠ê Marcar como favorita</span>
        </label>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancelar</button>
        <button type="submit" class="btn btn-success">üíæ Salvar Altera√ß√µes</button>
      </div>
    </form>
  </div>
</div>

<header>
  <div class="logo-container">
    <div class="logo">üéì</div>
    <div class="brand-text">F√≠sica M√©dica - Aulas</div>
  </div>
  <nav>
    <a href="#" class="active">üìö Aulas</a>
    <a href="https://github.com/diresidentedev" target="_blank">GitHub</a>
  </nav>
</header>

<main>
  <div class="page-header">
    <div class="header-content">
      <h1>üìö Biblioteca de Aulas</h1>
      <p>Material de apoio para resid√™ncia em F√≠sica M√©dica - Radioterapia</p>
    </div>
    <button class="btn btn-primary" onclick="openUploadModal()">
      <span>‚ûï</span> Nova Aula
    </button>
  </div>

  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">üìö</div>
      <div class="stat-info">
        <h3 id="totalAulas">0</h3>
        <p>Total de Aulas</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">‚≠ê</div>
      <div class="stat-info">
        <h3 id="totalFavoritas">0</h3>
        <p>Favoritas</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">üìÇ</div>
      <div class="stat-info">
        <h3 id="totalCategorias">0</h3>
        <p>Categorias</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">üëÅÔ∏è</div>
      <div class="stat-info">
        <h3 id="totalViews">0</h3>
        <p>Visualiza√ß√µes</p>
      </div>
    </div>
  </div>

  <div class="toolbar">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="üîç Buscar aulas..." oninput="filterAulas()">
    </div>
    <div class="filter-group">
      <select id="categoryFilter" onchange="filterAulas()">
        <option value="">üìÇ Todas Categorias</option>
        <option value="fisica-radiacao">F√≠sica das Radia√ß√µes</option>
        <option value="dosimetria">Dosimetria</option>
        <option value="controle-qualidade">Controle de Qualidade</option>
        <option value="planejamento">Planejamento</option>
        <option value="braquiterapia">Braquiterapia</option>
        <option value="radiobiologia">Radiobiologia</option>
        <option value="protecao-radiologica">Prote√ß√£o Radiol√≥gica</option>
        <option value="outros">Outros</option>
      </select>
      <select id="sortFilter" onchange="filterAulas()">
        <option value="recent">‚è∞ Mais Recentes</option>
        <option value="oldest">üìÖ Mais Antigas</option>
        <option value="name-asc">üî§ A-Z</option>
        <option value="name-desc">üî§ Z-A</option>
        <option value="favorites">‚≠ê Favoritas</option>
      </select>
      <button class="btn btn-icon" onclick="toggleView()" title="Alternar visualiza√ß√£o">
        <span id="viewIcon">üìã</span>
      </button>
    </div>
  </div>

  <div class="aulas-container" id="aulasContainer">
    <!-- Cards ser√£o renderizados aqui -->
  </div>
</main>

<footer>
  <div class="signature">
    <span>Desenvolvido por</span>
    <a href="https://diolando.dev" target="_blank" class="developer-name">diolando.dev</a>
    <span>¬© 2025</span>
  </div>
</footer>

<script>
// ==================== DATABASE ====================
const AULAS_INICIAIS = [
  {
    id: "icru-50-62",
    title: "ICRU 50 e 62 - Volumes de Tratamento",
    category: "planejamento",
    date: "2024-12-01",
    professor: "Diolando R L Silva",
    description: "Apresenta√ß√£o sobre os relat√≥rios ICRU 50 e 62, definindo os volumes de tratamento em radioterapia: GTV, CTV, PTV e √≥rg√£os de risco.",
    filePath: "aulas/icru/icru50_62.html",
    fileType: "html",
    favorite: true,
    views: 0,
    createdAt: "2024-12-01T00:00:00.000Z"
  },
  {
    id: "rdc20-2006",
    title: "RDC 20/2006 - Regulamenta√ß√£o em Radioterapia",
    category: "protecao-radiologica",
    date: "2025-01-15",
    professor: "Diolando R L Silva",
    description: "Regulamento T√©cnico para Funcionamento de Servi√ßos de Radioterapia - ANVISA. Equipe m√≠nima, equipamentos, garantia da qualidade e eventos adversos.",
    filePath: "aulas/regulamentos/rdc20_2006.html",
    fileType: "html",
    favorite: true,
    views: 0,
    createdAt: "2025-01-15T00:00:00.000Z"
  }
];

// ==================== STATE ====================
let aulas = [];
let isListView = false;

// ==================== INIT ====================
document.addEventListener('DOMContentLoaded', () => {
  loadAulas();
  renderAulas();
  updateStats();
});

// ==================== STORAGE ====================
function loadAulas() {
  const stored = localStorage.getItem('fismed_aulas');
  if (stored) {
    aulas = JSON.parse(stored);
  } else {
    // Primeira vez - carregar aulas iniciais
    aulas = [...AULAS_INICIAIS];
    saveToStorage();
  }
}

function saveToStorage() {
  localStorage.setItem('fismed_aulas', JSON.stringify(aulas));
}

// ==================== RENDER ====================
function renderAulas(list = aulas) {
  const container = document.getElementById('aulasContainer');
  
  if (list.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">üìö</div>
        <h3>Nenhuma aula encontrada</h3>
        <p>Adicione sua primeira aula ou ajuste os filtros!</p>
        <button class="btn btn-primary" onclick="openUploadModal()">
          ‚ûï Adicionar Aula
        </button>
      </div>
    `;
    return;
  }
  
  container.innerHTML = list.map(aula => createAulaCard(aula)).join('');
}

function createAulaCard(aula) {
  const categoryNames = {
    'fisica-radiacao': 'F√≠sica das Radia√ß√µes',
    'dosimetria': 'Dosimetria',
    'controle-qualidade': 'Controle de Qualidade',
    'planejamento': 'Planejamento',
    'braquiterapia': 'Braquiterapia',
    'radiobiologia': 'Radiobiologia',
    'protecao-radiologica': 'Prote√ß√£o Radiol√≥gica',
    'outros': 'Outros'
  };
  
  const fileIcons = {
    html: 'üåê',
    pdf: 'üìï',
    pptx: 'üìä',
    video: 'üé¨'
  };
  
  const dateFormatted = aula.date ? new Date(aula.date).toLocaleDateString('pt-BR') : '-';
  
  return `
    <div class="aula-card" data-id="${aula.id}">
      <div class="aula-card-header">
        <div class="aula-icon ${aula.fileType}">${fileIcons[aula.fileType] || 'üìÑ'}</div>
        <div class="aula-title">
          <h3>
            ${aula.favorite ? '<span class="favorite-star">‚≠ê</span>' : ''}
            ${aula.title}
          </h3>
          <span class="category-badge category-${aula.category}">${categoryNames[aula.category] || aula.category}</span>
        </div>
      </div>
      <div class="aula-card-body">
        <p class="aula-description">${aula.description || 'Sem descri√ß√£o'}</p>
        <div class="aula-meta">
          <span>üìÖ ${dateFormatted}</span>
          ${aula.professor ? `<span>üë®‚Äçüè´ ${aula.professor}</span>` : ''}
          <span>üëÅÔ∏è ${aula.views || 0}</span>
        </div>
      </div>
      <div class="aula-card-footer">
        <button class="btn btn-icon" onclick="event.stopPropagation(); toggleFavorite('${aula.id}')" title="Favoritar">
          ${aula.favorite ? '‚≠ê' : '‚òÜ'}
        </button>
        <button class="btn btn-icon" onclick="event.stopPropagation(); openEditModal('${aula.id}')" title="Editar">
          ‚úèÔ∏è
        </button>
        <button class="btn btn-icon" onclick="event.stopPropagation(); deleteAula('${aula.id}')" title="Excluir">
          üóëÔ∏è
        </button>
        <button class="btn btn-primary" onclick="event.stopPropagation(); openAula('${aula.id}')">
          Abrir ‚Üí
        </button>
      </div>
    </div>
  `;
}

// ==================== STATS ====================
function updateStats() {
  document.getElementById('totalAulas').textContent = aulas.length;
  document.getElementById('totalFavoritas').textContent = aulas.filter(a => a.favorite).length;
  
  const categories = new Set(aulas.map(a => a.category));
  document.getElementById('totalCategorias').textContent = categories.size;
  
  const totalViews = aulas.reduce((sum, a) => sum + (a.views || 0), 0);
  document.getElementById('totalViews').textContent = totalViews;
}

// ==================== FILTER & SORT ====================
function filterAulas() {
  const search = document.getElementById('searchInput').value.toLowerCase();
  const category = document.getElementById('categoryFilter').value;
  const sort = document.getElementById('sortFilter').value;
  
  let filtered = [...aulas];
  
  // Filter by search
  if (search) {
    filtered = filtered.filter(a => 
      a.title.toLowerCase().includes(search) ||
      (a.description && a.description.toLowerCase().includes(search)) ||
      (a.professor && a.professor.toLowerCase().includes(search))
    );
  }
  
  // Filter by category
  if (category) {
    filtered = filtered.filter(a => a.category === category);
  }
  
  // Sort
  switch (sort) {
    case 'recent':
      filtered.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
      break;
    case 'oldest':
      filtered.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
      break;
    case 'name-asc':
      filtered.sort((a, b) => a.title.localeCompare(b.title));
      break;
    case 'name-desc':
      filtered.sort((a, b) => b.title.localeCompare(a.title));
      break;
    case 'favorites':
      filtered.sort((a, b) => (b.favorite ? 1 : 0) - (a.favorite ? 1 : 0));
      break;
  }
  
  renderAulas(filtered);
}

function toggleView() {
  isListView = !isListView;
  const container = document.getElementById('aulasContainer');
  const icon = document.getElementById('viewIcon');
  
  if (isListView) {
    container.classList.add('list-view');
    icon.textContent = 'üìã';
  } else {
    container.classList.remove('list-view');
    icon.textContent = 'üìã';
  }
}

// ==================== CRUD ====================
function openAula(id) {
  const aula = aulas.find(a => a.id === id);
  if (!aula) return;
  
  // Increment views
  aula.views = (aula.views || 0) + 1;
  saveToStorage();
  updateStats();
  
  // Open file
  if (aula.filePath) {
    window.open(aula.filePath, '_blank');
  }
}

function saveAula(event) {
  event.preventDefault();
  
  const newAula = {
    id: 'aula-' + Date.now(),
    title: document.getElementById('aulaTitle').value,
    category: document.getElementById('aulaCategory').value,
    date: document.getElementById('aulaDate').value,
    professor: document.getElementById('aulaProfessor').value,
    description: document.getElementById('aulaDescription').value,
    filePath: document.getElementById('aulaFilePath').value,
    fileType: document.getElementById('aulaFileType').value,
    favorite: document.getElementById('aulaFavorite').checked,
    views: 0,
    createdAt: new Date().toISOString()
  };
  
  aulas.unshift(newAula);
  saveToStorage();
  renderAulas();
  updateStats();
  closeUploadModal();
  showToast('Aula adicionada com sucesso!', 'success');
  
  // Reset form
  document.getElementById('uploadForm').reset();
}

function updateAula(event) {
  event.preventDefault();
  
  const id = document.getElementById('editId').value;
  const index = aulas.findIndex(a => a.id === id);
  
  if (index === -1) return;
  
  aulas[index] = {
    ...aulas[index],
    title: document.getElementById('editTitle').value,
    category: document.getElementById('editCategory').value,
    date: document.getElementById('editDate').value,
    professor: document.getElementById('editProfessor').value,
    description: document.getElementById('editDescription').value,
    filePath: document.getElementById('editFilePath').value,
    favorite: document.getElementById('editFavorite').checked
  };
  
  saveToStorage();
  renderAulas();
  updateStats();
  closeEditModal();
  showToast('Aula atualizada com sucesso!', 'success');
}

function deleteAula(id) {
  if (!confirm('Tem certeza que deseja excluir esta aula?')) return;
  
  aulas = aulas.filter(a => a.id !== id);
  saveToStorage();
  renderAulas();
  updateStats();
  showToast('Aula exclu√≠da!', 'info');
}

function toggleFavorite(id) {
  const aula = aulas.find(a => a.id === id);
  if (!aula) return;
  
  aula.favorite = !aula.favorite;
  saveToStorage();
  renderAulas();
  updateStats();
}

// ==================== MODALS ====================
function openUploadModal() {
  document.getElementById('uploadModal').classList.add('active');
}

function closeUploadModal() {
  document.getElementById('uploadModal').classList.remove('active');
}

function openEditModal(id) {
  const aula = aulas.find(a => a.id === id);
  if (!aula) return;
  
  document.getElementById('editId').value = aula.id;
  document.getElementById('editTitle').value = aula.title;
  document.getElementById('editCategory').value = aula.category;
  document.getElementById('editDate').value = aula.date || '';
  document.getElementById('editProfessor').value = aula.professor || '';
  document.getElementById('editDescription').value = aula.description || '';
  document.getElementById('editFilePath').value = aula.filePath || '';
  document.getElementById('editFavorite').checked = aula.favorite;
  
  document.getElementById('editModal').classList.add('active');
}

function closeEditModal() {
  document.getElementById('editModal').classList.remove('active');
}

function closeViewModal() {
  document.getElementById('viewModal').classList.remove('active');
}

// ==================== TOAST ====================
function showToast(message, type = 'info') {
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  toast.innerHTML = `
    <span>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
    <span>${message}</span>
  `;
  container.appendChild(toast);
  
  setTimeout(() => {
    toast.style.opacity = '0';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// ==================== CLOSE MODALS ON OUTSIDE CLICK ====================
document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) {
      overlay.classList.remove('active');
    }
  });
});
</script>

</body>
</html>
